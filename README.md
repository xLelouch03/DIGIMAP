# DIGIMAP 

# Animal Classifier with Image Processing

## To build and run the app
- Make sure that `animal_classifier.pth` is placed on the same directory as the `app.py`
- The `animal_classifier.pth` can be generated by running the whole `super resolution.ipynb` notebook
- Run the python command `python app.py` on the terminal.
- 
## Alternatively
- To access the executable file, kindly proceed to the [Google Drive link](https://drive.google.com/drive/folders/1Rqbfg1ip_Ftxvo6M5-1zIJe_NtRCOgyM?usp=drive_link) and download both files.
- Make sure to keep the `animal_classifier.pth` and `app.exe` in the same directory to ensure that the app will run.
- OR -> Install PyInstaller through `pip install pyinstaller`
- Create the executable file with `pyinstaller --onefile app.py`
- Make sure that `animal_classifier.pth` is placed on the same directory as the `app.exe` (in dist/)


This application is a simple **image classification tool** built using **PyTorch** and **Tkinter**. It uses a pretrained **EfficientNet-B0** model to classify images of animals, and incorporates **data augmentation** techniques to enhance the images for better performance. The user can upload an image through the GUI, and the application will display the predicted animal class.

## Features

- **Image Classification**: Uses a pretrained EfficientNet-B0 model to predict the animal class in uploaded images.
- **Data Augmentation**: Applies various image enhancement techniques to improve the image quality before classification:
  - **Contrast Enhancement**: Using histogram equalization in HSV space to improve the image's contrast.
  - **Sharpening**: Enhancing image details by sharpening the image.
  - **Random Shifting**: Randomly shifting the image horizontally or vertically.
  - **Rotation**: Randomly rotating the image to account for different orientations.
  - **Flipping**: Randomly flipping the image horizontally or vertically.
  - **Black Patch Addition**: Introducing random black patches to simulate occlusions or image corruption.
  
These augmentations help provide a more robust input for classification by simulating different conditions that the model might encounter in real-world scenarios.

- **GUI**: Built with Tkinter, providing an intuitive interface for users to upload images and view predictions.

## How It Works

1. **Image Upload**: An image can be uploaded via a file dialog.
2. **Preprocessing and Augmentation**: The uploaded image undergoes preprocessing and data augmentation:
   - **Histogram Equalization**: The image's contrast is enhanced by equalizing the histogram in the HSV color space, focusing on the brightness (value) channel.
   - **Sharpening**: The image is sharpened using a factor of 2.0 to enhance fine details.
   - **Random Data Augmentation**: Several random augmentations are applied:
     - **Random Shifting**: The image is randomly shifted horizontally or vertically by a random number of pixels.
     - **Random Rotation**: The image is rotated by a random angle (between -20° and 20°).
     - **Random Flipping**: The image is flipped either horizontally or vertically.
     - **Random Black Patch**: A black patch of random size is applied to a random location in the image to simulate occlusion.
3. **Classification**: The augmented image is then passed through the pretrained EfficientNet-B0 model to classify the animal.
4. **Result**: The predicted animal class (e.g., "dog," "cat," "elephant") is displayed below the image.

